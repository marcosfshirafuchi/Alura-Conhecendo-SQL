-- 1. Traga todos os dados da cliente Maria Silva.
SELECT * from clientes WHERE nome like 'Maria Silva';

-- 2. Busque o ID do pedido e o ID do cliente dos pedidos onde o status esteja como entregue.
SELECT * from pedidos;
SELECT * from clientes;
SELECT p.id, p.idcliente from pedidos p WHERE status like 'entregue';

-- 3. Retorne todos os produtos onde o preço seja maior que 10 e menor que 15.
SELECT * from produtos;
SELECT * from produtos WHERE preco > 10 and preco < 15;

-- 4. Busque o nome e cargo dos colaboradores que foram contratados entre 2022-01-01 e 2022-06-30.
SELECT * from colaboradores;
SELECT nome, cargo from colaboradores WHERE datacontratacao BETWEEN '2022-01-01' AND '2022-06-30';

-- 5. Recupere o nome do cliente que fez o primeiro pedido.
SELECT * from clientes;
SELECT * from pedidos;

SELECT nome
FROM clientes
WHERE id = (
SELECT idcliente
                FROM pedidos
            ORDER BY datahorapedido asc
               LIMIT 1);
-- 6. Liste os produtos que nunca foram pedidos.
SELECT nome
FROM produtos
WHERE id NOT IN (
SELECT idProduto
            FROM itenspedidos);
-- 7. Liste os nomes dos clientes que fizeram pedidos entre 2023-01-01 e 2023-12-31.
SELECT * from pedidos;
SELECT c.nome from clientes c
inner join pedidos p 
on c.id = p.idcliente
WHERE p.datahorapedido BETWEEN '2023-01-01' and '2023-12-31';

-- 8. Recupere os nomes dos produtos que estão em menos de 15 pedidos.
select * from produtos;
select * from pedidos;
SELECT * from itenspedidos;

SELECT p.nome
FROM produtos AS p
INNER JOIN itenspedidos AS ip 
ON p.id = IP.idProduto
GROUP BY p.nome
HAVING COUNT(ip.idPedido) < 15;
-- 9. Liste os produtos e o ID do pedido que foram realizados pelo cliente "Pedro Alves" ou pela cliente "Ana Rodrigues".
select * from produtos;
SELECT * from pedidos;
select * from itenspedidos;
SELECT * from clientes;

select p.nome, ip.idpedido
from produtos p
inner join itenspedidos ip on ip.idproduto = p.id
INNER join pedidos pe on ip.idpedido = pe.id
inner join clientes c on pe.idcliente = c.id
WHERE c.nome in('Pedro Alves', 'Ana Rodrigues');

-- 10. Recupere o nome e o ID do cliente que mais comprou(valor) no Serenatto.
SELECT * from clientes;
SELECT * from pedidos;
SELECT * from itenspedidos;

SELECT
    c.id,
    c.nome,
    ROUND(SUM(ip.precounitario), 0) AS total_pedidos
FROM clientes c
INNER JOIN pedidos pd
    ON pd.idcliente = c.id
INNER JOIN itenspedidos ip
    ON ip.idpedido = pd.id
INNER JOIN produtos p
    ON p.id = ip.idproduto
GROUP BY c.id, c.nome
ORDER BY total_pedidos DESC
LIMIT 1