-- Quadro geral
SELECT strftime('%Y/%m', data_venda) as "Ano/Mes", COUNT(*) Qtd_Vendas
FROM vendas
GROUP BY "Ano/Mes"
ORDER BY "Ano/Mes";

SELECT strftime('%m', data_venda) as "Mes", COUNT(*) Qtd_Vendas
FROM vendas
GROUP BY "Mes"
ORDER BY "Mes";

SELECT strftime('%m', data_venda) as "Mes", strftime('%Y', data_venda) AS "Ano", COUNT(*) Qtd_Vendas
FROM vendas
GROUP BY "Mes"
ORDER BY "Mes";

SELECT Mes,
SUM(CASE WHEN Ano =='2020' THEN Qtd_Vendas ELSE 0 END) AS '2020',
SUM(CASE WHEN Ano =='2021' THEN Qtd_Vendas ELSE 0 END) AS '2021',
SUM(CASE WHEN Ano =='2022' THEN Qtd_Vendas ELSE 0 END) AS '2022',
SUM(CASE WHEN Ano =='2023' THEN Qtd_Vendas ELSE 0 END) AS '2023'
FROM(
SELECT strftime('%m', data_venda) as Mes, strftime('%Y', data_venda) AS Ano, COUNT(*) Qtd_Vendas
FROM vendas
GROUP BY Mes, Ano
ORDER BY Mes
)
GROUP by Mes
;